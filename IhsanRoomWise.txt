### Revised Project Context (Improved & AI-Readable)

RoomWise is a web-based Meeting Room Management System developed for an internal corporate environment at PT XYZ. The application is designed to replace manual meeting room scheduling methods such as spreadsheets, emails, and informal communication, which often result in schedule conflicts, inaccurate room availability information, and reduced productivity. The system centralizes all meeting room data, booking activities, and room statuses into a single, reliable platform accessible to both administrators and employees.
The application is built using ASP.NET MVC and follows a clean separation of concerns by implementing Models, Controllers, and Views. Models must remain simple and free from Data Annotations to maintain flexibility and readability. Authentication is handled through a centralized `AuthController`, while all other controllers follow a role-based naming convention using the `[Role]Controller` pattern (e.g., `AdminController`, `EmployeeController`) to enforce authorization boundaries clearly.
RoomWise supports role-based access control with two primary roles: Admin and Employee. Admin users have full system control, including managing users, rooms, schedules, and operational room statuses. Employees are able to view room availability, create and manage their own bookings, and provide feedback after meetings. The system enforces real-time validation to prevent schedule conflicts and ensures that room capacity and operational status are respected during the booking process.
The company operates across multiple physical locations, referred to internally as “Plants” for confidentiality purposes. Each Plant consists of multiple blocks and floors, and meeting rooms are associated with a specific Plant, block, and floor. This hierarchical location structure is reflected throughout the system to help users easily identify and filter meeting rooms based on physical location.
The user interface uses modern, professional styling with a corporate meeting-oriented visual theme. The login page includes a modern background image and the tagline “A Reliable and Organized Meeting Room Management.” All application text, labels, and messages are written in English for consistency and professionalism. Both Admin and Employee users have access to a profile page, with limited edit capabilities based on role.
The system also supports documentation and academic artifacts, including Use Case Diagrams, ERD, and Activity Diagrams, to support project reporting and future maintenance. Overall, RoomWise is designed to be scalable, transparent, user-friendly, and suitable for real-world corporate operations.

---

Admin Functionals and Requirements:
- Admin Manage User (crud | personal information, deactivate/activate & profile photos, utilize modals)
- Admin Manage Departments (crud | utilize this with a modal while inside user management while adding/editing departments field)
- Admin Manage Rooms (crud | status & avaibality, room photos, capacity, facilities (Projector, Smart Screen/TV, ScreenBeam, CiscoBar), and others, utilize modals | apply view option -> normal table, cards)
- Admin Manage Locations (crud | utilize this with a modal while inside room management while adding/editing locations field)
- Admin Manage Bookings (crud | monitorings, can create, others | apply view option -> normal table, calendar)
- Admin Manage Feedbacks (you know how , feedback photos, utilize modals)
- Admin Manage Notifications (crud | you can also create some kind of announcement, just simple, utilize modals | mark as read/unread)
- Admin Manage Personal Profile & Change Password
- Admin with some of these features, inside them utilize excel importation & exportation, and make sure the excel look good, cool, and colorful if you could, and has filters set for exportation
- Admin can see logs (activities, simply track record of stuffs)
- Utilize filters, filterized everything that can use filters (maximum please date filters, everybody needs it)

Employee Functionals and Requirements:
- Employee Find Rooms (browse & search & book | filter by location, capacity, facilities, date/time availability | apply view option -> normal table, cards with real-time status)
- Employee Create Booking (book meeting rooms | select date, time, duration, room, add meeting title, description, and make sure schedules will not clash, books dont crash)
- Employee All Bookings (crud | modify/edit or even cancel upcoming or just booked meetings and also stop/finishify the meeting if they finish early, system validates availability for edits, view personal booking history, upcoming and past meetings | apply view option -> normal table, calendar)
- Employee Submit Feedback (crud | rate room condition, facilities, cleanliness, report issues, attach photos if needed, cant delete/edit after admin replied, feedback photos | utilize modals)
- Employee View Notifications (receive booking confirmations, reminders, cancellations, admin announcements | mark as read/unread)
- Employee Manage Personal Profile & Change Password
- Employee with some of these features, inside them utilize excel exportation, and make sure the excel look good, cool, and colorful if you could, and has filters set for exportation
- Employee can see logs (activities of personal/one self, simply track record of personal stuffs)
- Utilize filters, filterized everything that can use filters (maximum please date filters, everybody needs it)

---

---------------------------------------------------------------------------------

<Project Sdk="Microsoft.NET.Sdk.Web">

  <PropertyGroup>
    <TargetFramework>net8.0</TargetFramework>
    <Nullable>enable</Nullable>
    <ImplicitUsings>enable</ImplicitUsings>
  </PropertyGroup>

  <ItemGroup>
    <Folder Include="Controllers\" />
    <Folder Include="wwwroot\images\" />
    <Folder Include="wwwroot\images\assets\" />
    <Folder Include="wwwroot\images\profiles\" />
    <Folder Include="wwwroot\images\rooms\" />
  </ItemGroup>

  <ItemGroup>
    <PackageReference Include="ClosedXML" Version="0.105.0" />
    <PackageReference Include="Microsoft.Data.SqlClient" Version="6.0.4" />
    <PackageReference Include="Newtonsoft.Json" Version="13.0.4" />
  </ItemGroup>

</Project>

---------------------------------------------------------------------------------

// Functions\DbAccessFunction.cs

using System;

namespace IhsanRoomWise.Functions
{
    public class DbAccessFunction
    {
        private readonly string connectionString;

        //constructor
        public DbAccessFunction()
        {
            // Your SQL Server connection string
            connectionString = @"Data Source=localhost\SQLEXPRESS;Initial Catalog=roomwise;Integrated Security=True;TrustServerCertificate=True";
        }

        // Method to get connection string - this is what your controller is looking for
        public string GetConnectionString()
        {
            return connectionString;
        }

    }

}

---------------------------------------------------------------------------------

// Functions\SecHelperFunction.cs

using System;
using System.Security.Cryptography;
using System.Text;

namespace IhsanRoomWise.Functions
{
    public static class SecHelperFunction
    {
        public static string HashPasswordMD5(string password)
        {
            using (MD5 md5 = MD5.Create())
            {
                byte[] inputBytes = Encoding.UTF8.GetBytes(password);
                byte[] hashBytes = md5.ComputeHash(inputBytes);

                StringBuilder sb = new StringBuilder();
                for (int i = 0; i < hashBytes.Length; i++)
                {
                    sb.Append(hashBytes[i].ToString("x2"));
                }
                return sb.ToString();
            }
        }

        public static string GenerateResetToken()
        {
            const string chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";
            byte[] randomBytes = new byte[32];
            using (var rng = RandomNumberGenerator.Create())
            {
                rng.GetBytes(randomBytes);
            }

            char[] result = new char[32];
            for (int i = 0; i < 32; i++)
            {
                result[i] = chars[randomBytes[i] % chars.Length];
            }
            return new string(result);
        }

        public static bool VerifyPassword(string providedPasswordHash, string storedPasswordHash)
        {
            return string.Equals(providedPasswordHash, storedPasswordHash, StringComparison.OrdinalIgnoreCase);
        }
    }
}

---------------------------------------------------------------------------------

// Functions\TagHelperFunction.cs

using System;
using Microsoft.AspNetCore.Mvc.Rendering;

namespace IhsanRoomWise.Function
{
    public static class TagHelperFunction
    {
        public static string IsActive(this IHtmlHelper helper, string controller, string action)
        {
            ViewContext context = helper.ViewContext;
            RouteValueDictionary values = context.RouteData.Values;
            string? _controller = values["controller"]?.ToString();
            string? _action = values["action"]?.ToString();
            
            if ((_action == action) && (_controller == controller))
            {
                return "active";
            }
            else
            {
                return "";
            }
        }
        
        public static string IsMenuOpen(this IHtmlHelper helper, string controller, string action)
        {
            ViewContext context = helper.ViewContext;
            RouteValueDictionary values = context.RouteData.Values;
            string? _controller = values["controller"]?.ToString();
            string? _action = values["action"]?.ToString();
            
            if ((_action == action) && (_controller == controller))
            {
                return "menu-open";
            }
            else
            {
                return "";
            }
        }
    }
}

---------------------------------------------------------------------------------

// Functions\AbrvHelperFunction.cs

using System;
using System.Linq;
using System.Text;
using System.Text.RegularExpressions;

namespace IhsanRoomWise.Functions
{
    public static class AbrvHelperFunction
    {
        public static string GenerateRoomCode(string roomName, string plantName, int block, int floor)
        {
            string abbreviation = GenerateAbbreviation(roomName);
            string plantNumber = ExtractPlantNumber(plantName);
            
            return $"{abbreviation}-P{plantNumber}-B{block}-F{floor}";
        }

        public static string GenerateAbbreviation(string roomName)
        {
            if (string.IsNullOrWhiteSpace(roomName))
                return "MR"; // Default: Meeting Room

            // Remove common words that don't add value to abbreviation
            string[] wordsToRemove = { "Room", "Meeting", "Conference", "The", "A", "An" };
            string cleanedName = roomName;

            foreach (string word in wordsToRemove)
            {
                cleanedName = Regex.Replace(cleanedName, $@"\b{word}\b", "", RegexOptions.IgnoreCase);
            }

            // Split by spaces and take first letter of each word
            string[] words = cleanedName.Split(new[] { ' ' }, StringSplitOptions.RemoveEmptyEntries);
            StringBuilder abbreviation = new StringBuilder();

            foreach (string word in words)
            {
                if (!string.IsNullOrWhiteSpace(word))
                {
                    abbreviation.Append(char.ToUpper(word[0]));
                }
            }

            // If abbreviation is empty or too short, use first 2-4 letters of original name
            if (abbreviation.Length == 0)
            {
                string alphanumeric = Regex.Replace(roomName, @"[^a-zA-Z0-9]", "");
                return alphanumeric.Length > 4 
                    ? alphanumeric.Substring(0, 4).ToUpper() 
                    : alphanumeric.ToUpper();
            }

            return abbreviation.ToString();
        }

        public static string ExtractPlantNumber(string plantName)
        {
            if (string.IsNullOrWhiteSpace(plantName))
                return "0";

            // Extract digits from plant name
            string digits = Regex.Replace(plantName, @"[^\d]", "");
            
            return string.IsNullOrEmpty(digits) ? "0" : digits;
        }

        public static string GenerateBookingCode(DateTime bookingDate, int sequenceNumber)
        {
            string dateStr = bookingDate.ToString("yyyyMMdd");
            string sequence = sequenceNumber.ToString("D3"); // Pad with zeros to 3 digits
            
            return $"BK-{dateStr}-{sequence}";
        }

        public static bool IsValidRoomCodeFormat(string roomCode)
        {
            if (string.IsNullOrWhiteSpace(roomCode))
                return false;

            // Pattern: ABBREVIATION-P[digit(s)]-B[digit(s)]-F[digit(s)]
            string pattern = @"^[A-Z0-9]+-P\d+-B\d+-F\d+$";
            return Regex.IsMatch(roomCode, pattern);
        }

        public static bool IsValidBookingCodeFormat(string bookingCode)
        {
            if (string.IsNullOrWhiteSpace(bookingCode))
                return false;

            // Pattern: BK-YYYYMMDD-XXX
            string pattern = @"^BK-\d{8}-\d{3}$";
            return Regex.IsMatch(bookingCode, pattern);
        }

        public static string GenerateCleanFilename(string input)
        {
            if (string.IsNullOrWhiteSpace(input))
                return "file";

            // Convert to lowercase and replace spaces with hyphens
            string clean = input.ToLower().Trim();
            clean = Regex.Replace(clean, @"[^a-z0-9\s-]", ""); // Remove special chars
            clean = Regex.Replace(clean, @"\s+", "-"); // Replace spaces with hyphens
            clean = Regex.Replace(clean, @"-+", "-"); // Remove duplicate hyphens
            
            return clean;
        }

        public static string GenerateInitials(string fullName)
        {
            if (string.IsNullOrWhiteSpace(fullName))
                return "??";

            string[] words = fullName.Split(new[] { ' ' }, StringSplitOptions.RemoveEmptyEntries);
            
            if (words.Length == 0)
                return "??";
            
            if (words.Length == 1)
                return words[0].Length > 1 
                    ? words[0].Substring(0, 2).ToUpper() 
                    : words[0].ToUpper();

            // Take first letter of first word and first letter of last word
            return $"{char.ToUpper(words[0][0])}{char.ToUpper(words[words.Length - 1][0])}";
        }

        public static string GeneratePreview(string text, int maxLength = 100)
        {
            if (string.IsNullOrWhiteSpace(text))
                return string.Empty;

            if (text.Length <= maxLength)
                return text;

            // Find the last space before maxLength to avoid cutting words
            int lastSpace = text.LastIndexOf(' ', maxLength);
            
            if (lastSpace > 0)
                return text.Substring(0, lastSpace) + "...";
            
            return text.Substring(0, maxLength) + "...";
        }
    }
}

---------------------------------------------------------------------------------

// Program.cs

using System;

var builder = WebApplication.CreateBuilder(args);

// Add services to the container.
builder.Services.AddControllersWithViews();

builder.Services.AddDistributedMemoryCache();

builder.Services.AddSession(options =>
{
    options.IdleTimeout = TimeSpan.FromHours(8); // Set to 8 hours or any desired duration
    options.Cookie.HttpOnly = true;
    options.Cookie.Name = ".IhsanRoomWise.Session"; // <--- Add line
    options.Cookie.IsEssential = true;
});

builder.Services.AddHttpContextAccessor();

var app = builder.Build();

// Configure the HTTP request pipeline.
if (!app.Environment.IsDevelopment())
{
    app.UseExceptionHandler("/Home/Error");
    // The default HSTS value is 30 days. You may want to change this for production scenarios, see https://aka.ms/aspnetcore-hsts.
    app.UseHsts();
}

//app.UseHttpsRedirection();
app.UseStaticFiles();

app.UseRouting();

app.UseAuthorization();

app.UseSession();

app.MapControllerRoute(
    name: "default",
    pattern: "{controller=Auth}/{action=LoginView}/{id?}");

app.Run();